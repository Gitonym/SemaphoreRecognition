# Automatic Semaphor Recognition System

## pose_2d_recognizer.py
Graphical tool that detects Semaphore letters based on 2D pose detection.

## collector
Graphical tool that detects Semaphore letters based on 3D pose detection. Can also save frames for easy data collection.

Call ```collector.py``` for graphical feedback of which letter is detected.

Call ```collector.py --save-data``` for saving the detected images in corresponding folder, saving only starts after letter was held for one second.

Call ```collector.py --save-data --save-letter X``` for saving all images in the X folder, saving only starts after X was held for one second.

## gui.py
This script starts a gui where an image can be loaded. The program returns the classification to the user using the model.

Set the path to the model in this line: ```model = tf.keras.models.load_model('fine_tuned.keras')```

## model
All files in this folder expect a different environment. The packages are defined in requirements.txt in this folder. Setting up CUDA and CUDNN is recommended for training.

## model/preprocess.py
This script preprocesses the data so it can be used with resnet and applies the train and test split.

It expects the testdata in the same dir. In the format that is generated by collector.py.

## model/main.py
This script trains the model and saves it. Expects 'train' and 'test' folders in the same dir as generated by preprocess.py.

Saves the model as ```fine_tuned.keras``` in the same dir.

## model/test.py
This script uses the testdata to generate metrics for the model. It also gives paths for missclassified images.
Expects the model and 'test' in the same dir.

# Results
```
              precision    recall  f1-score   support

           A       1.00      1.00      1.00        41
           B       1.00      1.00      1.00        62
           C       1.00      1.00      1.00        45
           D       1.00      1.00      1.00        55
           E       1.00      1.00      1.00        60
           F       1.00      0.96      0.98        56
           G       0.97      1.00      0.98        56
           H       1.00      1.00      1.00        66
           I       1.00      0.96      0.98        56
           J       0.98      0.98      0.98        63
           K       0.98      0.95      0.97        64
           L       0.94      1.00      0.97        68
           M       0.98      0.91      0.95        69
           N       0.94      1.00      0.97        59
           O       0.97      0.99      0.98        73
           P       0.94      0.98      0.96        66
           Q       0.93      0.89      0.91        61
           R       0.98      0.98      0.98        57
           S       0.92      1.00      0.96        54
           T       0.91      0.85      0.88        62
           U       0.84      1.00      0.91        52
           V       0.98      0.89      0.93        54
           W       0.93      0.98      0.96        55
           X       0.96      0.98      0.97        54
           Y       0.98      0.84      0.91        58
           Z       1.00      0.97      0.98        61

    accuracy                           0.97      1527
   macro avg       0.97      0.97      0.97      1527
weighted avg       0.97      0.97      0.97      1527

Confusion Matrix:

 [41  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 62  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 45  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 54  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 54  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 62  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1 61  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 63  4  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0 72  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 65  0  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  1 54  1  3  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1 56  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 54  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  1  0  0 53  6  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 52  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  5  0 48  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 54  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1 53  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  3  1  2  1 49  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  1 59]
 ```